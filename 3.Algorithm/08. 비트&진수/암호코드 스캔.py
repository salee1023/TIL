password = ['3211', '2221', '2122', '1411', '1132', '1231', '1114', '1312', '1213', '3112']


def into_binary():
    i = 0
    for row in arr:
        temp = ''
        for num in row:
            temp += format(int(num, 16), '04b')
        arr_binary[i].extend(temp)
        i += 1


def find_code(N, M):
    for n in range(N):
        m = M-1
        while m:
            if arr_binary[n][m] == '1':
                i = 1
                while arr_binary[n][m-(55*i)] != '0':
                    i += 1
                else:
                    codes.append(''.join(arr_binary[n][m-(55*i):m+1]))
                    for j in range(N):
                        arr_binary[j][m-(55 * i):m+1] = '0'
                    m -= 55*i-1
            else:
                m -= 1
        return


T = int(input())
for tc in range(1, 1+T):
    N, M = map(int, input().split())
    arr = [input() for _ in range(N)]
    arr_binary = [[] for _ in range(N)]
    codes = []
    # 2진수로 변환
    into_binary()
    for a in arr_binary:
        print(''.join(a))
    # 암호코드 찾기
    find_code(N, M*4)
    print(codes)


'''
1
16 26
00000000000000000000000000
00000000000000000000000000
000000001DB176C588D26EC000
000000001DB176C588D26EC000
000000001DB176C588D26EC000
000000001DB176C588D26EC000
000000001DB176C588D26EC000
000000001DB176C588D26EC000
000000001DB176C588D26EC000
000000001DB176C588D26EC000
000000001DB176C588D26EC000
000000001DB176C588D26EC000
000000001DB176C588D26EC000
000000001DB176C588D26EC000
00000000000000000000000000
00000000000000000000000000
'''
'''
1
100 26
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
0000000068B46DDB9346F40000
0000000068B46DDB9346F40000
0000000068B46DDB9346F40000
0000000068B46DDB9346F40000
0000000068B46DDB9346F40000
0000000068B46DDB9346F40000
0000000068B46DDB9346F40000
0000000068B46DDB9346F40000
0000000068B46DDB9346F40000
0000000068B46DDB9346F40000
0000000068B46DDB9346F40000
0000000068B46DDB9346F40000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
00000000000000000000000000
'''